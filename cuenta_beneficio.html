<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Generador - Distribución de Beneficios</title>
<style>
 :root{
  --bg:#f2f2f2; 
  --card:#ffffff; 
  --accent:#4caf50; 
  --muted:#666;
  --text:#111;
  --border:#ccc;
  --btn-ghost:#eee;
}

body{
  font-family:Inter,Arial,Helvetica,sans-serif;
  margin:0;
  background:var(--bg);
  color:var(--text);
  transition: all 0.3s ease;
}

.wrap{max-width:820px;margin:18px auto;padding:16px}
header{display:flex;align-items:center;justify-content:space-between;gap:12px}
h1{font-size:20px;color:var(--accent);margin:0}

.controls, .output{
  background:var(--card);
  border-radius:10px;
  padding:14px;
  margin-top:12px;
  box-shadow:0 6px 18px rgba(20,20,20,0.06);
  border:1px solid var(--border);
  transition: all 0.3s ease;
}

label{display:block;font-size:13px;color:var(--muted);margin-top:8px}
input[type="number"], input[type="text"], select{
  width:100%;
  padding:10px;
  border-radius:6px;
  border:1px solid var(--border);
  box-sizing:border-box;
  font-size:14px;
  background:var(--card);
  color:var(--text);
  transition: all 0.3s ease;
}

.row {display:flex;gap:10px;flex-wrap:wrap}
.col{flex:1;min-width:160px}
.btn {display:inline-block;padding:9px 12px;border-radius:8px;border:0;cursor:pointer;font-weight:600;transition:0.2s;}
.btn-green{background:var(--accent);color:#ffffff}
.btn-red{background:#f44336;color:#fff}
.btn-ghost{background:var(--btn-ghost);color:#111}
.btn:hover{opacity:0.85;}

.socios-list{margin-top:10px;display:flex;flex-direction:column;gap:8px}
.socio-item{display:flex;gap:8px;align-items:center}
.socio-item input{flex:1}
.small{font-size:12px;color:var(--muted)}

.partida {
  margin-top:14px;
  padding:12px;
  border-radius:8px;
  background-color: var(--card);
  border:1px solid rgba(0,0,0,0.08);
  transition: all 0.3s ease;
}

.part-title{font-weight:700;color:var(--accent);margin-bottom:8px}
.line{display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px dashed var(--border);}
.left{flex:2;font-size:14px}
.mid{flex:1;text-align:right;padding-right:8px;color:var(--text)}
.right{flex:1;text-align:right;color:var(--text)}
.line.no-border{border-bottom:0}
.registro{margin-top:8px;padding-top:8px;border-top:1px solid var(--border);font-weight:600}
.muted-block{font-size:13px;color:var(--muted);margin-top:6px}
footer{margin-top:18px;text-align:center;color:#666;font-size:13px}

@media (max-width:560px){
  .left{font-size:13px}
  .mid,.right{font-size:13px}
  .row{flex-direction:column}
  .col{min-width:0}
  #modoDark{width:auto}
}

/* === Modo oscuro mejorado === */
body.dark{
  --bg:#121317;
  --card:#1e1f24;
  --accent:#00d8ff;  /* azul vibrante */
  --muted:#aaaaaa;
  --text:#e7eef0;
  --border:#444;
  --btn-ghost:#333;
}

body.dark input[type="number"], body.dark input[type="text"], body.dark select{
  background:var(--card);
  color:var(--text);
  border:1px solid #555;
}

body.dark .controls, body.dark .output{
  background:var(--card);
  border:1px solid var(--border);
  box-shadow:0 4px 12px rgba(0,0,0,0.5);
}

body.dark .partida {
  background-color: var(--card);
  border:1px solid #555;
  color:var(--text);
}

body.dark .line{border-bottom:1px dashed #555;}
body.dark .registro{border-top:1px solid #555}
body.dark .btn-ghost{background:var(--btn-ghost);color:#00d8ff}
body.dark .btn-ghost:hover{background:#444;}

</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Distribución de Beneficios - Generador</h1>
    <div style="display:flex;gap:8px;align-items:center">
      <button id="modoDark" class="btn btn-ghost" onclick="toggleDark()">Modo oscuro</button>
      <button id="resetAll" class="btn btn-red" onclick="resetTodo()" title="Borrar todo">Limpiar</button>
    </div>
  </header>

  <section class="controls">
    <div class="row">
      <div class="col">
        <label>Ganancia antes de impuestos y reserva</label>
        <input id="gananciaAntes" type="number" min="0" step="0.01" placeholder="">
      </div>
      <div class="col">
        <label>% ISR a aplicar (ej. 25)</label>
        <input id="porcISR" type="number" min="0" max="100" step="0.01" value="25">
      </div>
      <div class="col">
        <label>% Reserva legal (ej. 5)</label>
        <input id="porcReserva" type="number" min="0" max="100" step="0.01" value="5">
      </div>
    </div>

    <div style="margin-top:12px;display:flex;gap:10px;align-items:center;flex-wrap:wrap">
      <div style="flex:1;min-width:220px">
        <label>Número de socios</label>
        <input id="numSocios" type="number" min="1" value="2">
        <div class="small">Pulsa <strong>Generar campos</strong> para crear inputs por socio</div>
      </div>
      <div style="flex:1;min-width:220px">
        <label>Medio de pago (para la distribución)</label>
        <select id="medioPago">
          <option value="Caja y Bancos">Caja y Bancos</option>
          <option value="Mercaderías">Mercaderías</option>
          <option value="Otros">Otros</option>
        </select>
      </div>
      <div style="min-width:180px;display:flex;gap:8px">
        <button class="btn btn-green" onclick="crearCamposSocios()">Generar campos</button>
        <button class="btn btn-ghost" onclick="distribucionIgual()">Distribución igual</button>
      </div>
    </div>

    <div class="socios-list" id="sociosList"></div>
    <div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end">
      <button class="btn btn-green" onclick="calcularYGenerar()">Calcular y Generar Partidas</button>
    </div>
    <div id="mensaje" class="muted-block tiny"></div>
  </section>

  <section class="output" id="salida"></section>
  <footer>Pagina creada por yo? | Derechos reservados</footer>
</div>

<script>
function fmt(n){ return Number(n).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2}); }
function q(n){ return Number((n||0)); }

let socios = [];
const sociosListEl = document.getElementById('sociosList');
const salidaEl = document.getElementById('salida');
const mensajeEl = document.getElementById('mensaje');

function crearCamposSocios(){
  const n = Math.max(1, parseInt(document.getElementById('numSocios').value || 1));
  socios = [];
  sociosListEl.innerHTML = '';
  for(let i=0;i<n;i++){
    const div = document.createElement('div');
    div.className = 'socio-item';
    div.style.display = 'flex';
    div.style.gap = '8px';
    const inp = document.createElement('input');
    inp.type = 'text';
    inp.placeholder = (i===0? 'Ramírez' : i===1? 'Pérez' : `Socio ${i+1}`);
    inp.value = inp.placeholder;
    inp.dataset.idx = i;
    const del = document.createElement('button');
    del.className = 'btn btn-ghost';
    del.textContent = 'Eliminar';
    del.onclick = ()=>{ div.remove(); rebuildSocios(); };
    div.appendChild(inp);
    div.appendChild(del);
    sociosListEl.appendChild(div);
  }
  rebuildSocios();
}

function rebuildSocios(){
  socios = [];
  const inputs = sociosListEl.querySelectorAll('input[type=text]');
  inputs.forEach(inp => {
    socios.push({ nombre: inp.value.trim() || inp.placeholder });
  });
  document.getElementById('numSocios').value = Math.max(1, socios.length);
}

function distribucionIgual(){
  rebuildSocios();
  if(socios.length===0) { alert('Agrega al menos 1 socio'); return; }
  mensajeEl.textContent = `La ganancia neta se repartirá en partes iguales entre ${socios.length} socios.`;
  setTimeout(()=> mensajeEl.textContent='', 4000);
}

function calcularYGenerar(){
  rebuildSocios();
  const gananciaAntes = q(document.getElementById('gananciaAntes').value);
  const porcISR = q(document.getElementById('porcISR').value) / 100;
  const porcReserva = q(document.getElementById('porcReserva').value) / 100;
  const medioPago = document.getElementById('medioPago').value || 'Caja y Bancos';

  if(gananciaAntes <= 0){ alert('Ingresa la ganancia antes de impuestos y reserva'); return; }
  if(socios.length === 0){ alert('Agrega al menos un socio'); return; }

  const montoISR = gananciaAntes * porcISR;
  const montoReserva = gananciaAntes * porcReserva;
  const gananciaNeta = gananciaAntes - montoISR - montoReserva;
  const porSocio = gananciaNeta / socios.length;
  salidaEl.innerHTML = '';

  const part1 = document.createElement('div');
  part1.className = 'partida';
  part1.innerHTML = `<div class="part-title">Partida 1 — Cálculo ISR y Reserva Legal</div>
    <div class="line"><div class="left">Ganancia antes de impuesto y reserva</div><div class="mid">${fmt(gananciaAntes)}</div><div class="right"></div></div>
    <div class="line"><div class="left">a: ISR por pagar (${(porcISR*100).toFixed(2)}%)</div><div class="mid"></div><div class="right">${fmt(montoISR)}</div></div>
    <div class="line"><div class="left">a: Reserva legal (${(porcReserva*100).toFixed(2)}%)</div><div class="mid"></div><div class="right">${fmt(montoReserva)}</div></div>
    <div class="line no-border"><div class="left">a: Ganancia después de impuesto y reserva</div><div class="mid"></div><div class="right">${fmt(gananciaNeta)}</div></div>
    <div class="registro">Registro del cálculo del ISR y de la reserva legal según la ley</div>`;
  salidaEl.appendChild(part1);

  const part2 = document.createElement('div');
  part2.className = 'partida';
  part2.innerHTML = `<div class="part-title">Partida 2 — Distribución de Ganancia Neta</div>
    <div class="line"><div class="left">Ganancia después de impuesto y reserva</div><div class="mid">${fmt(gananciaNeta)}</div><div class="right"></div></div>`;
  socios.forEach(s=>{
    const row = document.createElement('div');
    row.className = 'line no-border';
    row.innerHTML = `<div class="left">a: Cuenta beneficio socio ${escapeHtml(s.nombre)}</div><div class="mid"></div><div class="right">${fmt(porSocio)}</div>`;
    part2.appendChild(row);
  });
  part2.innerHTML += `<div class="registro">Registro de la distribución de la ganancia entre ${socios.length} socio(s)</div>`;
  salidaEl.appendChild(part2);

  const part3 = document.createElement('div');
  part3.className = 'partida';
  part3.innerHTML = `<div class="part-title">Partida 3 — Pago de la Ganancia a los Socios</div>`;
  socios.forEach(s=>{
    const r = document.createElement('div');
    r.className = 'line';
    r.innerHTML = `<div class="left">Cuenta beneficio socio ${escapeHtml(s.nombre)}</div><div class="mid">${fmt(porSocio)}</div><div class="right"></div>`;
    part3.appendChild(r);
  });
  const totalPagar = porSocio * socios.length;
  const medioRow = document.createElement('div');
  medioRow.className = 'line no-border';
  medioRow.innerHTML = `<div class="left">a: ${escapeHtml(medioPago)}</div><div class="mid"></div><div class="right">${fmt(totalPagar)}</div>`;
  part3.appendChild(medioRow);
  part3.innerHTML += `<div class="registro">Registro del pago de la ganancia a los socios mediante "${escapeHtml(medioPago)}"</div>`;
  salidaEl.appendChild(part3);

  mensajeEl.textContent = `Generado: ISR ${fmt(montoISR)}, Reserva ${fmt(montoReserva)}, Ganancia Neta ${fmt(gananciaNeta)}. Reparto ${fmt(porSocio)} por socio.`;
  setTimeout(()=> mensajeEl.textContent = '', 7000);
}

function escapeHtml(s){
  return (s+"").replace(/[&<>"']/g, c=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[c]));
}

function borrarSalida(){ salidaEl.innerHTML = ''; }
function resetTodo(){
  if(!confirm('Limpiar todo (campos y salida)?')) return;
  document.getElementById('gananciaAntes').value='';
  document.getElementById('porcISR').value='25';
  document.getElementById('porcReserva').value='5';
  document.getElementById('numSocios').value='2';
  document.getElementById('medioPago').value='Caja y Bancos';
  sociosListEl.innerHTML='';
  socios = [];
  salidaEl.innerHTML='';
  mensajeEl.textContent='';
}

function toggleDark(){
  document.body.classList.toggle('dark');
  document.getElementById('modoDark').textContent = document.body.classList.contains('dark') ? 'Modo claro' : 'Modo oscuro';
}

(function init(){
  document.getElementById('gananciaAntes').value = 450000;
  document.getElementById('numSocios').value = 2;
  crearCamposSocios();
})();
</script>
</body>
</html>
